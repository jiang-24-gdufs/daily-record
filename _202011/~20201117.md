## 工作流连线

需要数据 1. 节点 2. 矢量

```ts
interface Node {
	id: string;
	name: string;
}
interface Edge {
    from: string;
    to: string
}
```

难点重点: 如何保持编辑保存和加载内容图形一致.. ~ 前后端保存对应的配置

bnpm.js 仅仅保存了基础图元

SaaS 的工作许需要有矢量边的信息..



## 流模型

1. DMN - 决策模型标记

2. BPMN - 

3. CMMN - 案件管理模型和符号

   > DMN侧重的是决策
   >
   > BPMN侧重的是流程管理
   >
   > CMMN侧重的是案例

![BPMN CMMN DMN说明](.\imgs\1583758277336.png)



## DAG 有向无环图

JS 流程图插件备选方案

1. jsplumb

2. dagre-d3 

   Dagre-D3最大的优点就是可以实现自动布局，你只需要put数据就可以

   缺点就是自动布局后的连线会比较乱，而且连线不是横平竖直的，对于流程图不复杂的还好，稍微复杂点画出来的连线就没法看。

3. jointjs 

4. flowchart.js 

5. vue-simple-flowchart ~ 上面的Vue简版



### 归纳

1. dagre-d3 [开源PowerJob自带]

   - 优点: 依据数据自动布局, 前后端只需要统一数据, 不需要保存其表现数据
   - 缺点:  自动布局后的连线会比较乱，而且连线不是横平竖直的, 复杂的流程图的连线混乱不清; 不可编辑节点内容; 无逻辑处理

2. vue-bnpm [体验地址](https://demo.bpmn.io/new)

   一个流程图设计生产svg可视化图形工具库

   - 优点: 节点类型丰富, 可自定义编辑节点内容, 支持定义边界条件;
   - 缺点: 使用门槛相对较高; **输出数据为SVG, 没有节点内容和矢量线相关的信息, 与现有接口不符;**  前端展示保存完毕的设计图需要使用svg, 需要后台协助保存;
   - 其他: 支持定义边界条件功能需要额外设置一套规则并解析;

3. vue-simple-flowchart [体验地址](https://jeffreyrn.github.io/vue-simple-flowchart/demo/)

   一个轻量级流程图编辑器

   - 优点: 节点自带输入/输出口操作简单; 节点之间的矢量线是鼠标拖拽操作; 输出结果与接口所需数据字段类似;
   - 缺点: 节点多连线多也避免不了混乱的问题; 为了前后展示效果一致, 后台协助保存相关的节点位置信息;  不可编辑节点内容; 无逻辑处理
   - 其他: 可以通过鼠标交互实现更多提示/查看/编辑功能;

| 个人评价[0到5分]     | 开发难度 | 可拓展性 | 美观性 |
| -------------------- | -------- | -------- | ------ |
| dagre-d3             | 0        | 0        | 1      |
| vue-bnpm             | 5        | 2        | 4      |
| vue-simple-flowchart | 2        | 3        | 3      |

